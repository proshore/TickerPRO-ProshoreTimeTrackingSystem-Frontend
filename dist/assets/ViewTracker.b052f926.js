import{A as S,C as j,r as v,B as U,o as r,c as i,a as t,F as C,g as V,t as f,y as k,D as x,u as I,h as g,p as N,d as K,H as F,I as H,z as q,J as W,i as J,E as O,b as $}from"./index.c127f3b4.js";import{T as Y,_ as G}from"./BaseHeading.b0c9d164.js";import{_ as z}from"./plugin-vue_export-helper.21dcd24c.js";import{p as Q}from"./index.5a154a9c.js";import"./logo.5b10267d.js";const X="/api/log/add-entry",Z="/api/log/edit-entry",tt="/api/log/view-logs",et="/api/log/remove";var E={TRACKER_ADD:X,TRACKER_EDIT:Z,TRACKER_LIST:tt,TRACKER_DELETE:et};const at=async(e,n)=>await S.post(E.TRACKER_ADD,e,{headers:{Authorization:n}}),P=async(e,n,a)=>await S.post(`${E.TRACKER_EDIT}/${a}`,e,{headers:{Authorization:n}}),nt=async(e,n)=>await S.get(`${E.TRACKER_LIST}/${n}`,{headers:{authorization:e}}),ot=async(e,n)=>await S.get(`${E.TRACKER_DELETE}/${n}`,{headers:{authorization:e}});function st(e){return e.sort((n,a)=>new Date(a.end_time)-new Date(n.end_time)),e}function R(e){return e.toString().padStart(2,"0")}function lt(e){let n=Math.floor(e/1e3),a=Math.floor(n/60),l=Math.floor(a/60);return n=n%60,a=n>=30?a+1:a,a=a%60,l=l%24,`${R(l)}:${R(a)}:${R(n)}`}function rt(e,n){const a=new Date(n)-new Date(e);return new Date(a)}const it=e=>(N("data-v-7e9caff0"),e=e(),K(),e),ct={key:0,class:"mt-5 border border-bottom-0 rounded"},ut={class:"table table-hover"},dt=it(()=>t("thead",{class:"text-primary"},[t("tr",null,[t("th",{scope:"col"},"#"),t("th",{scope:"col"},"Activity Name"),t("th",{scope:"col"},"Project Id"),t("th",{scope:"col"},"Billability"),t("th",{scope:"col"},"Start Time"),t("th",{scope:"col"},"End Time"),t("th",{scope:"col"},"Action"),t("th",{scope:"col"},"Total Time"),t("th",{scope:"col"})])],-1)),_t={key:0},pt=["textContent"],mt=["onUpdate:modelValue"],ht=["textContent"],vt=["textContent"],bt={class:"dropdown-menu","aria-labelledby":"dropdownMenuButton1"},yt=["onClick"],ft=["onClick"],gt=["onUpdate:modelValue"],Tt=["onUpdate:modelValue"],wt=["onClick"],kt=["onClick"],$t={key:1,class:"mt-5 text-danger mx-1"},xt={key:0},Ct={key:2},St={setup(e){const n=j(),a=v([]),l=v(!0),c=U().user.id;async function p(){try{const u=await nt(n,c);u.status===200&&u.data.logs&&(a.value=u.data.logs,st(a.value)),l.value=!1}catch{alert("Something went wrong, please try again later")}}p();async function m(u,y,o,w,h,D,A){try{var L={activity_name:u,user_id:y,project_id:o,billable:w,start_time:h,end_time:D};(await P(L,n,A)).status==200&&(p(),alert("Time Log Updated Successfully"))}catch{alert("Error: unable to edit the time log.")}}async function b(u){try{(await ot(n,u)).status===200&&(alert("Timelog deleted successfully"),p(),a.value.length===1&&location.reload())}catch{alert("Error: unable to delete the time log.")}}function T(u){return u==!0?"Billable":"Non Billable"}return(u,y)=>(r(),i(C,null,[a.value.length?(r(),i("div",ct,[t("table",ut,[dt,a.value.length?(r(),i("tbody",_t,[(r(!0),i(C,null,V(a.value,(o,w)=>(r(),i("tr",{key:o.id},[t("th",{scope:"row",class:"align-middle",textContent:f(w+1)},null,8,pt),t("td",null,[k(t("input",{class:"edit",type:"text","onUpdate:modelValue":h=>o.activity_name=h},null,8,mt),[[x,o.activity_name]])]),t("td",null,[t("div",{textContent:f(o.project_id)},null,8,ht)]),t("td",null,[t("button",{class:"btn btn-light btn-sm",type:"button",id:"dropdownMenuButton1","data-bs-toggle":"dropdown",textContent:f(T(o.billable)),"aria-expanded":"true"},null,8,vt),t("ul",bt,[t("li",null,[t("a",{class:"dropdown-item",onClick:()=>o.billable=!0}," Billable ",8,yt)]),t("li",null,[t("a",{class:"dropdown-item",onClick:()=>o.billable=!1}," Non Billable ",8,ft)])])]),t("td",null,[k(t("input",{class:"edit",type:"text","onUpdate:modelValue":h=>o.start_time=h},null,8,gt),[[x,o.start_time]])]),t("td",null,[k(t("input",{class:"edit",type:"text","onUpdate:modelValue":h=>o.end_time=h},null,8,Tt),[[x,o.end_time]])]),t("td",null,[t("button",{onClick:h=>m(o.activity_name,I(c),o.project_id,o.billable,o.start_time,o.end_time,o.id),class:"btn btn-light btn-sm"}," Edit ",8,wt),t("button",{class:"btn btn-light btn-sm mx-2",onClick:h=>b(o.id)}," Delete ",8,kt)]),t("td",null,f(I(lt)(I(rt)(o.start_time,o.end_time))),1)]))),128))])):g("",!0)])])):(r(),i("p",$t,[l.value?g("",!0):(r(),i("span",xt,"No time logs. Let's start tracking"))])),l.value?(r(),i("p",Ct,"Loading...")):g("",!0)],64))}};var Et=z(St,[["__scopeId","data-v-7e9caff0"]]);function M(){const e=new Date,n=e.getFullYear();let a=e.getMonth()+1,l=e.getDate(),c=e.getHours(),p=e.getMinutes(),m=e.getSeconds();return a=a<10?`0${a}`:a,l=l<10?`0${l}`:l,c=c<10?`0${c}`:c,p=p<10?`0${p}`:p,m=m<10?`0${m}`:m,`${n}-${a}-${l} ${c}:${p}:${m}`}const Dt=e=>(N("data-v-0dcd3acf"),e=e(),K(),e),At={class:"tracker px-3 py-2 border rounded shadow-sm"},Lt=["onSubmit"],Bt=Dt(()=>t("label",{for:"project",class:"px-3"},"Projects",-1)),It=["value","textContent"],Rt={key:1,class:"text-danger"},Mt=["title"],jt=["textContent"],Ut={key:3,type:"submit",class:"btn btn-secondary mb-2 mx-4"},Vt={setup(e){const n=v(""),a=v(null),l=v([]),c=v(!1),p=v(!0),m=v(!1),b=v(null),T=v("00:00:00"),u=j();let y=0,o=null;function w(){y++;let s=Math.floor(y/3600),_=Math.floor((y-s*3600)/60),d=y%60;d<10&&(d="0"+d),_<10&&(_="0"+_),s<10&&(s="0"+s),T.value=`${s}:${_}:${d}`}function h(){o||(o=setInterval(w,1e3))}function D(){clearInterval(o),o=null}F(async()=>{try{const s=await Q(u);s.status===200&&(l.value=s.data.users)}catch{alert("Something went wrong, please try again later")}}),H(a,()=>{l.value.forEach(s=>{s.id===a.value&&(c.value=s.billable)})});async function A(){const s=M(),_=U().user.id,d={activity_name:n.value,user_id:_,project_id:a.value,billable:c.value,start_time:s};try{const B=await at(d,u);B.status===200&&(p.value=!1,m.value=!0,h(),b.value=B.data.log)}catch{alert("Something went wrong, please try again later")}}async function L(){try{const s={activity_name:b.value.activity_name,user_id:b.value.user_id,project_id:b.value.project_id,billable:b.value.billable,start_time:b.value.start_time,end_time:M()};(await P(s,u,b.value.id)).status===200&&(m.value=!1,p.value=!0,n.value="",a.value="",c.value=!1,D(),alert("Time log added successfully"),location.reload())}catch{alert("Something went wrong, please try again later")}}return(s,_)=>(r(),i("div",At,[t("form",{onSubmit:J(A,["prevent"]),class:""},[k(t("input",{type:"text",class:"form-control",id:"description","aria-describedby":"description",placeholder:"What are you working on?","onUpdate:modelValue":_[0]||(_[0]=d=>n.value=d),required:""},null,512),[[x,n.value]]),Bt,l.value.length?k((r(),i("select",{key:0,id:"project",class:"form-select","onUpdate:modelValue":_[1]||(_[1]=d=>a.value=d),"aria-label":"projects",required:""},[(r(!0),i(C,null,V(l.value,d=>(r(),i("option",{key:d.id,value:d.id,textContent:f(d.project_name)},null,8,It))),128))],512)),[[q,a.value]]):(r(),i("span",Rt," No projects. ")),t("span",{class:W(["dollar px-3 py-3",{"text-primary":c.value}]),title:c.value?"Billable":"Non billable",onClick:_[2]||(_[2]=d=>c.value=!c.value)}," $ ",10,Mt),T.value?(r(),i("span",{key:2,class:"fw-bold",textContent:f(T.value)},null,8,jt)):g("",!0),p.value?(r(),i("button",Ut," START ")):g("",!0),m.value?(r(),i("a",{key:4,onClick:L,class:"btn btn-primary text-white mb-2 mx-4"}," STOP ")):g("",!0)],40,Lt)]))}};var Nt=z(Vt,[["__scopeId","data-v-0dcd3acf"]]);const qt={setup(e){const n=O();return n.userStatus=!1,(a,l)=>(r(),i(C,null,[$(Y),t("main",null,[$(G,{title:"Time Tracker"}),$(Nt),$(Et)])],64))}};export{qt as default};
